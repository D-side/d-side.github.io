---
layout: post
title: Туманный интернет вещей
---

Позависав на YouTube, я обратил внимание на то, что на относительно "технических" каналах, когда речь заходит о потребительских "умных устройствах", в комментариях пренепременно высказывают своё отвращение к "интернету вещей" как к понятию, утверждают что каждое умное устройство с Wi-Fi в доме это мина замедленного действия, и что они ни за что не станут устанавливать дома ничего подобного. Да и вне YouTube такие взгляды весьма популярны. Почему?

## Потребители

К сожалению, такова сложившаяся ситуация на 2019 год. Практически любое потребительское умное устройство хочет доступ в интернет. И хочет оно его, как правило, для непосредственной эксплуатации.

Ведь что отличает "умное" устройство от обычного? Возможность взаимодействия с другими устройствами вместо единственно ручного управления. Вот именно это взаимодействие производители обычно и реализуют через интернет. Почему? Наверное, стоит спросить у них, но я попробую угадать. Просто потому что **это проще всего**, для них. Гораздо проще научить устройство взаимодействовать с чем угодно, если подключить его к сети, откуда потенциально можно получить доступ к чему угодно.

Но у этого есть цена: открытие устройству доступа к интернету требует немалой осторожности. Необходимо жёстко исключить любые варианты эксплуатации устройства, не лежащие в числе намерений пользователя. Попросту говоря, взлом. Причём это касается не только самого устройства, но и серверов с которыми оно общается. И так сложилось, что производители не особенно осторожничают. Такое впечатление, что либо в компаниях сегмента IoT просто нет квалифицированных безопасников, либо им не дают выполнять свою работу. Очень популярна шутка <abbr title="очевидно, там нет этой буквы">"буква S в IoT означает Security"</abbr>. Шутка, на мой взгляд, весьма обидная, ибо сильно очерняет всю концепцию, которая попросту плохо реализована. Но насколько плохо?

Регулярно всплывают новости о том, что кто-то нашёл лазейку на сервер и получил доступ ко всем умным устройствам целой серии по всему миру. Из последнего сходу припоминаю истории о камерах Ring и кормушках Xiaomi, но таких историй множество.

Бывают и случаи, что в устройствах обнаруживаются локальные уязвимости, и хотя они обычно не настолько опасны, особенно для людей за <abbr title="Network Address Translation, механизм размещения множества пользователей за одним IP-адресом">NAT</abbr> своих интернет-провайдеров, они могут сделать направленные атаки значительно проще. Хотя бывает, что такие уязвимости оказываются полезными *в правильных руках*, ибо позволяют вскрыть логику работы устройства и протокол работы с ним, а порой даже заменить прошивку на собственную. Но к этому мы вернёмся потом.

Плачевная ситуация, в общем. Как к ней пришли, сказать затрудняюсь, но для меня это выглядит как недостаточный спрос на безопасность среди потребителей (что, хочется верить, со временем пройдёт) и недостаточная ответственность производителей за безопасность.

## Не совсем потребители

Но среди потребителей есть группа, которая успешно берёт эти самые "опасные" устройства и использует их так, что риск эксплуатации становится минимальным. Как правило, чтобы это осуществить, нужно перекрыть устройству доступ в интернет и наладить собственный способ взаимодействия с ним. За неимением стандарта, который соблюдает сколько-нибудь существенная часть производителей, собираются коллекции решений для разнообразных линеек устройств и приводятся к общему формату -- примерно это представляют собой проекты OpenHAB и Home Assistant.

С производителями у них отношения сложные и разнообразные.

Как правило, никакие. Из-за их сравнительной малочисленности производители могут себе позволить просто не обращать на них внимания. И в этом случае происходит "мирное сосуществование": производитель не чешется, группа довольствуется работающим решением. А в случае если их устройства ведут себя неправильно, заявить, что они никогда и не обещали что-либо им предоставлять за рамками собственных решений. За этим был замечен Logitech -- их "универсальный пульт управления" Harmony в какой-то момент получил обновление, напрочь перекрывшее возможность управлять им собствеными средствами.

Бывают, впрочем, более приятные примеры: Yeelight, например, позволяет переводить свои осветительные приборы в "режим разработчика", открывающий возможность управения ими из локальной сети, к которой они подключены.

Только вот какая неприятность: эта группа потребителей почти полностью содержится в группе людей, которых волнует безопасность IoT, чем уменьшает число тех, кто мог бы заставлять производителей уделять ей больше внимания. 

## Аналитика

Производители нынче очень любят собирать о своих пользователях всё что только могут, чтобы либо глубже исследовать рынок, либо улучшить работу всяких предугадывающих алгоритмов... не принципиально. Важно что они хотят знать максимум информации о том, как используются их устройства. Наверняка поэтому производители предпочитают, чтобы их устройства управлялись их же средствами. Среди прочих причин, разумеется.

## Практичность

Есть один совершенно несвязанный с безопасностью повод использовать локальное средство управления: *скорость*. В локальной сети есть возможность реагировать гораздо быстрее.

Я как-то даже попытался это проверить, сделав переключение света в комнате из ламп Yeelight посредством HTTP-запроса (который делал с наручных часов, но это дело десятое). Разница вышла весьма внушительная:

* Официальными средствами, через интеграцию Yeelight с IFTTT и вебхук IFTTT, типичное время реакции было **4-7 секунд, иногда доходя до 15 секунд**, за каковое время можно успеть достать смартфон, разблокировать, открыть приложение Yeelight и включить свет через него. Хотя это "активное" время, тогда как задержка время "пассивное", не требующее каких-либо действий.
* Home Assistant, взаимодействующий с лампами через локальную сеть посредством "режима разработчика", реагировал обычно за **полсекунды, в худшем случае две**. Бонус: управление по локальной сети работает даже когда интернет отключен. Что у меня иногда случается.

## Классификация

Чтобы помочь пользователям с выбором устройств и осознанием способа интеграции с ними, Home Assistant у себя в документации использует "класс IoT":